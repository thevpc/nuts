"use strict";(self.webpackChunknuts=self.webpackChunknuts||[]).push([[7482],{1990:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var t=a(4848),i=a(8453);const s={id:"nutsApp",title:"Your first Application using nuts",sidebar_label:"Your first Application using nuts"},o=void 0,r={id:"dev/nutsApp",title:"Your first Application using nuts",description:"Running your application with Nuts",source:"@site/docs/dev/nuts-app.md",sourceDirName:"dev",slug:"/dev/nutsApp",permalink:"/nuts/docs/dev/nutsApp",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/dev/nuts-app.md",tags:[],version:"current",frontMatter:{id:"nutsApp",title:"Your first Application using nuts",sidebar_label:"Your first Application using nuts"},sidebar:"tutorialSidebar",previous:{title:"Your first Application using NAF",permalink:"/nuts/docs/dev/nutsAppNAF"},next:{title:"Nuts Descriptor Integration",permalink:"/nuts/docs/dev/nutsDescriptorIntegration"}},p={},c=[{value:"Running your application with Nuts",id:"running-your-application-with-nuts",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"running-your-application-with-nuts",children:"Running your application with Nuts"}),"\n",(0,t.jsxs)(n.p,{children:["Lets take, step by step, an example of an application that you will run using ",(0,t.jsx)(n.code,{children:"nuts"})," package manager"]}),"\n",(0,t.jsxs)(n.p,{children:["First we can create the project using your favourite IDE or using simply ",(0,t.jsx)(n.code,{children:"mvn"})," command"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mvn archetype:generate -DgroupId=com.mycompany.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-simple -DarchetypeVersion=1.4 -DinteractiveMode=false\n"})}),"\n",(0,t.jsx)(n.p,{children:"We will have a fully generated java project"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"~/> tree\n.\n\u2514\u2500\u2500 my-app\n    \u251c\u2500\u2500 pom.xml\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 main\n        \u2502   \u2514\u2500\u2500 java\n        \u2502       \u2514\u2500\u2500 com\n        \u2502           \u2514\u2500\u2500 mycompany\n        \u2502               \u2514\u2500\u2500 app\n        \u2502                   \u2514\u2500\u2500 App.java\n        \u2514\u2500\u2500 test\n            \u2514\u2500\u2500 java\n                \u2514\u2500\u2500 com\n                    \u2514\u2500\u2500 mycompany\n                        \u2514\u2500\u2500 app\n                            \u2514\u2500\u2500 AppTest.java\n\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now we will add some dependencies to the project. Let's add ",(0,t.jsx)(n.code,{children:"jexcelapi:jxl#2.4.2"})," and update ",(0,t.jsx)(n.code,{children:"pom.xml"})," consequently."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.mycompany.app</groupId>\n    <artifactId>my-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>jar</packaging>\n    <dependencies>\n        <dependency>\n            <groupId>jexcelapi</groupId>\n            <artifactId>jxl</artifactId>\n            <version>2.4.2</version>\n        </dependency>\n    </dependencies>\n    <properties>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <maven.compiler.source>1.8</maven.compiler.source>\n        <maven.compiler.target>1.8</maven.compiler.target>\n    </properties>\n</project> \n'})}),"\n",(0,t.jsx)(n.p,{children:"Now we update the App.java file"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'package com.mycompany.app;\n\nimport java.io.File;\n\nimport jxl.Workbook;\nimport jxl.write.WritableWorkbook;\n\npublic class App {\n\n    public static void main(String[] args) {\n        try {\n            WritableWorkbook w = Workbook.createWorkbook(new File("any-file.xls"));\n            System.out.println("Workbook just created");\n        } catch (Exception ex) {\n            ex.printStackTrace();\n        }\n    }\n}\n\n'})}),"\n",(0,t.jsx)(n.p,{children:"finally we compile the app:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mvn clean install\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Of course, we won't be able to run the application yet. Would we? For this app to work there are several ways, all of\nthem are complicated and require modifying the ",(0,t.jsx)(n.code,{children:"pom.xml"}),"  and even modifying the output jar. we can for instance generate an\noutput lib directory and update the ",(0,t.jsx)(n.code,{children:"META-INF"})," file using ",(0,t.jsx)(n.code,{children:"maven-dependency-plugin"}),".\n(see ",(0,t.jsx)(n.a,{href:"https://maven.apache.org/plugins/maven-shade-plugin",children:"https://maven.apache.org/plugins/maven-shade-plugin"})," ; ",(0,t.jsx)(n.a,{href:"https://www.baeldung.com/executable-jar-with-maven",children:"https://www.baeldung.com/executable-jar-with-maven"}),"). We\ncould also use ",(0,t.jsx)(n.code,{children:"maven-assembly-plugin"})," to include the dependencies into the jar itself ('what the fat' jar!).\nAnother alternative is to use an uglier solution with ",(0,t.jsx)(n.code,{children:"maven-shade-plugin"})," and blend libraries into the main jar. In\nall cases we need as well to configure ",(0,t.jsx)(n.code,{children:"maven-jar-plugin"})," to specify the main class file."]}),"\n",(0,t.jsxs)(n.p,{children:["I am not exposing all solutions here. You can read this article for more\ndetails (",(0,t.jsx)(n.a,{href:"https://www.baeldung.com/executable-jar-with-maven",children:"https://www.baeldung.com/executable-jar-with-maven"}),") but trust me, they all stink."]}),"\n",(0,t.jsxs)(n.p,{children:["Instead of that we will use ",(0,t.jsx)(n.code,{children:"nuts"}),". In that case, actually we are already done, the app is already OK! We do not need\nto specify the main class neither are we required to bundle ",(0,t.jsx)(n.code,{children:"jxl"})," and its dependencies. We only need to run the app.\nThat's it."]}),"\n",(0,t.jsxs)(n.p,{children:["Basically, you can install the application using its identifier ",(0,t.jsx)(n.code,{children:"com.mycompany.app:my-app"}),". The latest version will be resolved."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nuts install com.mycompany.app:my-app\nnuts my-app\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will install the application and run it on the fly. Dependencies will be detected, resolved and downloaded. The\napplication is installed from local maven repository. It needs to be deployed to a public repository for it to be\npublicly accessible, however."}),"\n",(0,t.jsx)(n.p,{children:"We can also choose not to install the app and bundle it as a jar. No need for a public repository in that case:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nuts -y com my-app-1.0.0-SNAPSHOT.jar\n"})}),"\n",(0,t.jsxs)(n.p,{children:["As we can see, ",(0,t.jsx)(n.code,{children:"nuts"})," provides the simplest and the most elegant way to deploy your application."]}),"\n",(0,t.jsxs)(n.p,{children:["One question though. what happens if we define multiple main methods (in multiple public classes). It is handled as well\nby ",(0,t.jsx)(n.code,{children:"nuts"})," seamlessly. It just asks, at runtime, for the appropriate class to run."]}),"\n",(0,t.jsx)(n.h1,{id:"using-nuts-application-framework",children:"Using Nuts Application Framework"}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.code,{children:"nuts"})," is transparent as we have seen so far. It is transparent both at build time and runtime.\nHowever, ",(0,t.jsx)(n.code,{children:"nuts"})," can provide our application a set of unique helpful features, such as install and uninstall hooks,\ncomprehensive command line support and so on."]}),"\n",(0,t.jsxs)(n.p,{children:["To create your first ",(0,t.jsx)(n.code,{children:"NAF"})," application, you will need to add nuts as a dependency and change your ",(0,t.jsx)(n.code,{children:"pom.xml"})," as follows:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.mycompany.app</groupId>\n    <artifactId>my-app</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>jar</packaging>\n    <dependencies>\n        <dependency>\n            <groupId>net.thevpc.nuts</groupId>\n            <artifactId>nuts-api</artifactId>\n            <version>0.8.4</version>\n        </dependency>\n        <dependency>\n            <groupId>jexcelapi</groupId>\n            <artifactId>jxl</artifactId>\n            <version>2.4.2</version>\n        </dependency>\n    </dependencies>\n    <properties>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <maven.compiler.source>1.8</maven.compiler.source>\n        <maven.compiler.target>1.8</maven.compiler.target>\n        <nuts.application>true</nuts.application>\n    </properties>\n</project> \n'})}),"\n",(0,t.jsxs)(n.p,{children:["Please take note that we have added a property ",(0,t.jsx)(n.code,{children:"nuts.application=true"}),".\nActually this is not mandatory, but this will help ",(0,t.jsx)(n.code,{children:"nuts"})," package manager detect that this application uses NAF before downloading its jar (the information will be available in the ",(0,t.jsx)(n.code,{children:"pom.xml"})," descriptor on the remote repository)."]}),"\n",(0,t.jsx)(n.p,{children:'Then we will add some cool features to our application. We write a dummy message whenever the application is installed, uninstalled or updated.\nWe will also add support to "--file=[path]" argument to specify the workbook path.'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'package com.mycompany.app;\n\nimport java.io.File;\n\nimport jxl.Workbook;\nimport jxl.write.WritableWorkbook;\n\npublic class App implements NApplication {\n\n    public static void main(String[] args) {\n        // just create an instance and call runAndExit in the main method\n        new App().runAndExit(args);\n    }\n\n    @Override\n    public void run(NSession session) {\n        NCmdLine cmd = session.getAppCmdLine();\n        File file = new File("file.xls");\n        while (cmd.hasNext()) {\n            switch (cmd.getKey().getString()) {\n                case "--file": {\n                    NArg a = cmd.nextEntry().get();\n                    file = new File(a.getStringValue());\n                    break;\n                }\n                case "--fill": {\n                    // process other options here ...\n                    break;\n                }\n                default: {\n                    s.configureLast(cmd);\n                }\n            }\n        }\n        try {\n            WritableWorkbook w = Workbook.createWorkbook(file);\n            s.out().printf("Workbook just created at %s%n", file);\n        } catch (Exception ex) {\n            ex.printStackTrace(s.err());\n        }\n    }\n\n    @Override\n    public void onInstallApplication(NSession s) {\n        s.out().printf("we are installing My Application : %s%n", s.getAppId());\n    }\n\n    @Override\n    public void onUninstallApplication(NSession s) {\n        s.out().printf("we are uninstalling My Application : %s%n", s.getAppId());\n    }\n\n    @Override\n    public void onUpdateApplication(NSession s) {\n        s.out().printf("we are updating My Application : %s%n", s.getAppId());\n    }\n}\n\n'})}),"\n",(0,t.jsx)(n.p,{children:"Now we can install or uninstall the application and see the expected messages."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nuts -y install com.mycompany.app:my-app\nnuts -y uninstall com.mycompany.app:my-app\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>r});var t=a(6540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);